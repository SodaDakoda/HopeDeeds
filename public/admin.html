<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard | HopeDeeds</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <!-- Custom Styles -->
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <!-- Header -->
    <header>
      <div class="container">
        <nav>
          <div class="logo">Hope<span>Deeds</span> (Admin)</div>
          <ul class="nav-links">
            <li>
              <a href="organization_dashboard.html"
                ><i class="fas fa-briefcase"></i> Organization View</a
              >
            </li>
            <li>
              <a href="/org/logout"
                ><i class="fas fa-sign-out-alt"></i> Logout</a
              >
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <!-- Main -->
    <main>
      <div
        class="container admin-layout"
        style="
          display: grid;
          grid-template-columns: 1fr 3fr;
          gap: 30px;
          padding: 40px 0;
        "
      >
        <!-- Sidebar -->
        <aside
          class="sidebar"
          style="
            background-color: var(--white);
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow-light);
            border-left: 5px solid var(--secondary);
          "
        >
          <h3 style="margin-bottom: 15px; color: var(--primary)">
            <i class="fas fa-tools"></i> Admin Tools
          </h3>
          <ul class="sidebar-nav" style="list-style: none; padding-left: 0">
            <li><a href="#volunteers" class="active">Volunteers</a></li>
            <li><a href="#shifts">Shifts</a></li>
            <li><a href="#reports">Reports</a></li>
            <li><a href="#settings">Settings</a></li>
          </ul>
        </aside>

        <!-- Content -->
        <section
          class="admin-content"
          style="
            background-color: var(--white);
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow-light);
            border-left: 5px solid var(--secondary);
          "
        >
          <!-- Volunteers -->
          <div id="volunteers">
            <h2><i class="fas fa-users"></i> Volunteer Management</h2>

            <table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Status</th>
                  <th>Zipcode</th>
                  <th>Joined</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="volunteer-table-body">
                <tr>
                  <td colspan="5">Loading volunteers...</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Reports -->
          <div id="reports" class="dashboard-section" style="margin-top: 50px">
            <h2><i class="fas fa-chart-line"></i> Reports & Analytics</h2>
            <p>
              Generate insights and performance reports for volunteer
              participation and retention.
            </p>
            <button class="btn btn-primary mt-3">
              <i class="fas fa-file-alt"></i> Generate Report
            </button>
          </div>
        </section>
      </div>
    </main>

    <!-- Footer -->
    <footer>
      <div class="container footer-content">
        <div class="footer-section">
          <h4>HopeDeeds</h4>
          <p>&copy; 2025 Volunteer Management Platform.</p>
        </div>
        <div class="footer-section">
          <h4>Contact</h4>
          <p>Email: info@hopedeeds.org</p>
        </div>
        <div class="footer-section">
          <h4>Connect</h4>
          <ul class="social-links">
            <li>
              <a href="#"><i class="fab fa-facebook-f"></i></a>
            </li>
            <li>
              <a href="#"><i class="fab fa-twitter"></i></a>
            </li>
            <li>
              <a href="#"><i class="fab fa-instagram"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </footer>

    <!-- Script: Load Volunteers Dynamically -->
    <script>
      async function loadVolunteers() {
        const tbody = document.getElementById("volunteer-table-body");
        tbody.innerHTML = "<tr><td colspan='5'>Loading volunteers...</td></tr>";

        try {
          const res = await fetch("/admin/volunteers");
          if (!res.ok) throw new Error("Failed to fetch volunteers");
          const volunteers = await res.json();
          tbody.innerHTML = "";

          if (!volunteers.length) {
            tbody.innerHTML =
              "<tr><td colspan='5' style='text-align:center;color:gray;'>No volunteers found.</td></tr>";
            return;
          }

          volunteers.forEach((v) => {
            const status = v.waiver_agreed ? "Active" : "Pending Waiver";
            const statusClass = v.waiver_agreed
              ? "status-active"
              : "status-pending";

            const row = `
              <tr>
                <td>${v.full_name}</td>
                <td class="${statusClass}">${status}</td>
                <td>${v.zipcode || ""}</td>
                <td>${new Date(v.created_at).toLocaleDateString()}</td>
                <td><a href="#" style="color: var(--secondary);">View</a></td>
              </tr>`;
            tbody.insertAdjacentHTML("beforeend", row);
          });
        } catch (err) {
          console.error("Error loading volunteers:", err);
          tbody.innerHTML =
            "<tr><td colspan='5' style='color:red;'>Error loading volunteers.</td></tr>";
        }
      }

      document.addEventListener("DOMContentLoaded", loadVolunteers);
    </script>
  </body>
</html>
